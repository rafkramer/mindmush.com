import{f as y,a as c,t as S,c as $e,s as I}from"../chunks/CrWmIGs7.js";import{p as Pe,d as R,h as ee,f as j,b as u,a as ye,s as a,c as p,g as e,n as C,r as o,i as te,t as H,u as re}from"../chunks/IT3EpKRj.js";import{s as ke,i as ae,a as se}from"../chunks/D1N_oX3-.js";import{e as oe,i as ne,s as Ce}from"../chunks/DNuC7A3a.js";import{I as D,b as le}from"../chunks/BKroYgKh.js";import{a as F}from"../chunks/DQourb8u.js";import{v as ie}from"../chunks/BQ8b0Sla.js";import{t as B}from"../chunks/5lEJ7jwK.js";import{B as M}from"../chunks/BQmtcL2g.js";import{M as de,P as Ee,S as ce}from"../chunks/Bq9pQbsU.js";import{B as Ue}from"../chunks/a13RqEVw.js";import{S as Ae}from"../chunks/CevT2u2T.js";var Me=y("<!> Add Partner",1),qe=y('<span class="inline-flex items-center gap-1 px-2.5 py-1 bg-white/[0.035] rounded-full text-[11px] text-white/75"> <span class="text-indigo-400 font-semibold"> </span></span>'),ze=y('<div class="flex flex-wrap gap-1.5"></div>'),Ne=y('<p class="text-xs text-white/45">No ventures assigned</p>'),Se=y("<!> Edit",1),je=y('<div class="flex items-center gap-5 p-5 bg-white/[0.025] border border-white/[0.05] rounded-2xl hover:border-white/[0.08] transition-all"><div> </div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2.5 mb-1"><span class="font-medium text-white"> </span> <!></div> <!></div> <!></div>'),Be=y('<div class="p-6 space-y-5"><!> <!> <!> <div class="space-y-2"><label for="newContract" class="block text-[11px] font-semibold text-white/45 uppercase tracking-wider">Contract Notes (optional)</label> <textarea id="newContract" class="w-full px-4 py-3.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm min-h-[100px] resize-y placeholder:text-white/45 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/25 focus:outline-none" placeholder="Enter contract terms..."></textarea></div></div> <div class="flex justify-end gap-3 px-6 py-5 border-t border-white/[0.05] bg-black/20"><!> <!></div>',1),Ie=y('<div class="p-6 space-y-5"><!> <!> <!> <div class="space-y-2"><label for="editContract" class="block text-[11px] font-semibold text-white/45 uppercase tracking-wider">Contract Notes</label> <textarea id="editContract" class="w-full px-4 py-3.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm min-h-[100px] resize-y placeholder:text-white/45 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/25 focus:outline-none" placeholder="Enter contract terms..."></textarea></div></div> <div class="flex justify-between px-6 py-5 border-t border-white/[0.05] bg-black/20"><!> <div class="flex gap-3"><!> <!></div></div>',1),Re=y('<div class="animate-fade-in"><div class="flex justify-between items-start mb-7"><div><h1 class="text-2xl font-semibold tracking-tight">Partners</h1> <p class="text-sm text-white/45 mt-1">Manage team access</p></div> <!></div> <div class="space-y-3"></div></div> <!> <!>',1);function Xe(ue,pe){Pe(pe,!0);const J=()=>se(ie,"$ventures",L),K=()=>se(F,"$auth",L),[L,ve]=ke();let q=R(!1),E=R(!1),f=R(null),l=R(ee({username:"",password:"",role:"partner",contract:""})),m=R(ee({password:"",role:"partner",contract:""}));const Q=[{value:"partner",label:"Partner"},{value:"admin",label:"Admin"}];function fe(t){return J().filter(r=>r.partners.some(s=>s.userId===t)).map(r=>{const s=r.partners.find(i=>i.userId===t);return{name:r.name,equity:(s==null?void 0:s.equity)||0}})}function me(){if(!e(l).username.trim()||!e(l).password){B.show("Please fill in all required fields","error");return}if(K().users.some(r=>r.username===e(l).username.trim())){B.show("Username already exists","error");return}F.addUser({username:e(l).username.trim(),password:e(l).password,role:e(l).role,contract:e(l).contract}),B.show("Partner added successfully","success"),u(q,!1),u(l,{username:"",password:"",role:"partner",contract:""},!0)}function xe(t){u(f,t,!0),u(m,{password:"",role:t.role,contract:t.contract||""},!0),u(E,!0)}function _e(){if(!e(f))return;const t={role:e(m).role,contract:e(m).contract};e(m).password&&(t.password=e(m).password),F.updateUser(e(f).id,t),B.show("Partner updated successfully","success"),u(E,!1),u(f,null)}function he(){if(e(f)){if(e(f).username==="admin"){B.show("Cannot delete admin account","error");return}confirm("Are you sure you want to delete this partner?")&&(J().forEach(t=>{const r=t.partners.filter(s=>{var i;return s.userId!==((i=e(f))==null?void 0:i.id)});r.length!==t.partners.length&&ie.updatePartners(t.id,r)}),F.deleteUser(e(f).id),B.show("Partner deleted","success"),u(E,!1),u(f,null))}}var T=Re(),O=j(T),G=p(O),we=a(p(G),2);M(we,{onclick:()=>u(q,!0),children:(t,r)=>{var s=Me(),i=j(s);Ee(i,{size:16}),C(),c(t,s)},$$slots:{default:!0}}),o(G);var W=a(G,2);oe(W,5,()=>K().users,ne,(t,r)=>{const s=re(()=>fe(e(r).id));var i=je(),w=p(i);let g;var U=p(w,!0);o(w);var x=a(w,2),b=p(x),$=p(b),A=p($,!0);o($);var z=a($,2);{let v=re(()=>e(r).role==="admin"?"purple":"green");Ue(z,{get variant(){return e(v)},children:(_,n)=>{C();var h=S();H(()=>I(h,e(r).role)),c(_,h)},$$slots:{default:!0}})}o(b);var d=a(b,2);{var N=v=>{var _=ze();oe(_,21,()=>e(s),ne,(n,h)=>{var P=qe(),Y=p(P),Z=a(Y),be=p(Z);o(Z),o(P),H(()=>{I(Y,`${e(h).name??""} `),I(be,`${e(h).equity??""}%`)}),c(n,P)}),o(_),c(v,_)},k=v=>{var _=Ne();c(v,_)};ae(d,v=>{e(s).length>0?v(N):v(k,!1)})}o(x);var V=a(x,2);M(V,{variant:"secondary",size:"sm",onclick:()=>xe(e(r)),children:(v,_)=>{var n=Se(),h=j(n);Ae(h,{size:14}),C(),c(v,n)},$$slots:{default:!0}}),o(i),H(v=>{g=Ce(w,1,"w-12 h-12 rounded-xl flex items-center justify-center text-lg font-semibold text-white shrink-0",null,g,{"bg-gradient-to-br":!0,"from-indigo-500":e(r).role==="admin","to-purple-500":e(r).role==="admin","from-green-500":e(r).role==="partner","to-emerald-500":e(r).role==="partner"}),I(U,v),I(A,e(r).username)},[()=>e(r).username.charAt(0).toUpperCase()]),c(t,i)}),o(W),o(O);var X=a(O,2);de(X,{title:"Add New Partner",onclose:()=>u(q,!1),get open(){return e(q)},set open(t){u(q,t,!0)},children:(t,r)=>{var s=Be(),i=j(s),w=p(i);D(w,{id:"username",label:"Username",placeholder:"Enter username",get value(){return e(l).username},set value(d){e(l).username=d}});var g=a(w,2);D(g,{id:"password",type:"password",label:"Password",placeholder:"Enter password",get value(){return e(l).password},set value(d){e(l).password=d}});var U=a(g,2);ce(U,{id:"role",label:"Role",get options(){return Q},get value(){return e(l).role},set value(d){e(l).role=d}});var x=a(U,2),b=a(p(x),2);te(b),o(x),o(i);var $=a(i,2),A=p($);M(A,{variant:"ghost",onclick:()=>u(q,!1),children:(d,N)=>{C();var k=S("Cancel");c(d,k)},$$slots:{default:!0}});var z=a(A,2);M(z,{onclick:me,children:(d,N)=>{C();var k=S("Add Partner");c(d,k)},$$slots:{default:!0}}),o($),le(b,()=>e(l).contract,d=>e(l).contract=d),c(t,s)},$$slots:{default:!0}});var ge=a(X,2);de(ge,{title:"Edit Partner",onclose:()=>u(E,!1),get open(){return e(E)},set open(t){u(E,t,!0)},children:(t,r)=>{var s=$e(),i=j(s);{var w=g=>{var U=Ie(),x=j(U),b=p(x);D(b,{id:"editUsername",label:"Username",get value(){return e(f).username},readonly:!0});var $=a(b,2);D($,{id:"editPassword",type:"password",label:"New Password (leave blank to keep)",placeholder:"Enter new password",get value(){return e(m).password},set value(n){e(m).password=n}});var A=a($,2);ce(A,{id:"editRole",label:"Role",get options(){return Q},get value(){return e(m).role},set value(n){e(m).role=n}});var z=a(A,2),d=a(p(z),2);te(d),o(z),o(x);var N=a(x,2),k=p(N);M(k,{variant:"danger",onclick:he,children:(n,h)=>{C();var P=S("Delete");c(n,P)},$$slots:{default:!0}});var V=a(k,2),v=p(V);M(v,{variant:"ghost",onclick:()=>u(E,!1),children:(n,h)=>{C();var P=S("Cancel");c(n,P)},$$slots:{default:!0}});var _=a(v,2);M(_,{onclick:_e,children:(n,h)=>{C();var P=S("Save");c(n,P)},$$slots:{default:!0}}),o(V),o(N),le(d,()=>e(m).contract,n=>e(m).contract=n),c(g,U)};ae(i,g=>{e(f)&&g(w)})}c(t,s)},$$slots:{default:!0}}),c(ue,T),ye(),ve()}export{Xe as component};
